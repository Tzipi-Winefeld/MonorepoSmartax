<!-- <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
  </div>
  <div>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>
  <div>
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="workLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>מספר עובד</th>
          <th>תאריך</th>
          <th>כניסה</th>
          <th>יציאה</th>
          <th>שעות עבודה</th>
          <th>פעולות</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-log>
        <tr>
          <td>{{ log.employeeId }}</td>
          <td>{{ log.date | date: 'dd/MM/yyyy' }}</td>
          <td>{{ log.checkIn | date: 'HH:mm' }}</td>
          <td>{{ log.checkOut ? (log.checkOut | date: 'HH:mm') : '---' }}</td>
          <td>{{ log.hoursWorked ? log.hoursWorked.toFixed(2) : '---' }}</td>
          <td>
            <p-button label="עריכה" icon="pi pi-pencil" (click)="editWorkLog(log)"></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div>
    <label>חודש</label>
    <input pInputText type="number" [(ngModel)]="exportMonth" placeholder="חודש">
    <label>שנה</label>
    <input pInputText type="number" [(ngModel)]="exportYear" placeholder="שנה">
    <p-button label="ייצוא" icon="pi pi-file-excel" (click)="exportWorkLogs(exportMonth, exportYear)"></p-button>
  </div>

  <p-dialog header="עריכת שעות עבודה" [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{width: '50vw', height: '50vh'}">
    <div class="p-grid p-fluid">
      <div class="p-field">
        <label for="checkIn">כניסה</label>
        <p-calendar [(ngModel)]="editedCheckIn" timeOnly="true" showTime="true" hourFormat="24"></p-calendar>
      </div>
      <div class="p-field">
        <label for="checkOut">יציאה</label>
        <p-calendar [(ngModel)]="editedCheckOut" timeOnly="true" showTime="true" hourFormat="24"></p-calendar>
      </div>
    </div>
    <p-footer>
      <p-button label="שמור" icon="pi pi-check" (click)="saveEditedWorkLog()"></p-button>
      <p-button label="ביטול" icon="pi pi-times" (click)="cancelEdit()"></p-button>
    </p-footer>
  </p-dialog> -->

<!-- <div>
  <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
  </div>
  <div>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>
  <div>
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="workLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>מספר עובד</th>
          <th>תאריך</th>
          <th>כניסה</th>
          <th>יציאה</th>
          <th>שעות עבודה</th>
          <th>שעות נוספות</th>
          <th>פעולות</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-log>
        <tr>
          <td>{{ log.employeeId }}</td>
          <td>{{ log.date | date: 'dd/MM/yyyy' }}</td>
          <td>{{ log.checkIn | date: 'HH:mm' }}</td>
          <td>{{ log.checkOut ? (log.checkOut | date: 'HH:mm') : '---' }}</td>
          <td>{{ log.hoursWorked ? log.hoursWorked.toFixed(2) : '---' }}</td>
          <td>
            {{ log.hoursWorked && log.hoursWorked > 8.4 ? (log.hoursWorked - 8.4).toFixed(2) : '0.00' }}
          </td>
          <td>
            <p-button label="עריכה" icon="pi pi-pencil" (click)="editWorkLog(log)"></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div>
    <label>חודש</label>
    <input pInputText type="number" [(ngModel)]="exportMonth" placeholder="חודש">
    <label>שנה</label>
    <input pInputText type="number" [(ngModel)]="exportYear" placeholder="שנה">
    <p-button label="ייצוא לאקסל" icon="pi pi-file-excel" (click)="exportWorkLogs(exportMonth, exportYear)"></p-button>
  </div>

  <p-dialog header="עריכת שעות עבודה" [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{width: '50vw', height: '100vh'}">
    <div class="p-grid p-fluid">
      <div class="p-field">
        <label for="checkIn">כניסה</label>
        <p-calendar [(ngModel)]="editedCheckIn" dateFormat="dd/mm/yy" showTime="true" hourFormat="24"></p-calendar>
      </div>
      <div class="p-field">
        <label for="checkOut">יציאה</label>
        <p-calendar [(ngModel)]="editedCheckOut" dateFormat="dd/mm/yy" showTime="true" hourFormat="24"></p-calendar>
      </div>
    </div>
    <p-footer>
      <p-button label="שמור" icon="pi pi-check" (click)="saveEditedWorkLog()"></p-button>
      <p-button label="ביטול" icon="pi pi-times" (click)="cancelEdit()"></p-button>
    </p-footer>
  </p-dialog>
</div> -->
<!-- <div>
  <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
  </div>
  <div>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>
  <div>
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="workLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>מספר עובד</th>
          <th>תאריך</th>
          <th>כניסה</th>
          <th>יציאה</th>
          <th>שעות עבודה כולל</th>
          <th>פעולות</th>
        </tr>
      </ng-template>
      
<ng-template pTemplate="body" let-log>
  <tr>
    <td>{{ log.employeeId }}</td>
    <td>{{ log.date | date: 'dd/MM/yyyy' }}</td>
    <td>
      <ng-container *ngFor="let timeEntry of log.timeEntries">
        {{ timeEntry.checkIn | date: 'HH:mm' }}
        <br *ngIf="timeEntry.checkOut" />
      </ng-container>
    </td>
    <td>
      <ng-container *ngFor="let timeEntry of log.timeEntries">
        {{ timeEntry.checkOut ? (timeEntry.checkOut | date: 'HH:mm') : '---' }}
        <br *ngIf="!timeEntry.checkOut" />
      </ng-container>
    </td>
    <td>{{ log.allhoursWorked ? log.allhoursWorked.toFixed(2) : '---' }}</td>
    <td>
      <p-button label="עריכה" icon="pi pi-pencil" (click)="editWorkLog(log)"></p-button>
    </td>
  </tr>
</ng-template>
    </p-table>
  </div>

  <div>
    <label>חודש</label>
    <input pInputText type="number" [(ngModel)]="exportMonth" placeholder="חודש">
    <label>שנה</label>
    <input pInputText type="number" [(ngModel)]="exportYear" placeholder="שנה">
    <p-button label="ייצוא לאקסל" icon="pi pi-file-excel" (click)="exportWorkLogs(exportMonth, exportYear)"></p-button>
  </div>

  <p-dialog header="עריכת שעות עבודה" [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{width: '50vw', height: '100vh'}">
    <div class="p-grid p-fluid">
      <div class="p-field">
        <label for="checkIn">כניסה</label>
        <p-calendar [(ngModel)]="editedCheckIn" dateFormat="dd/mm/yy" showTime="true" hourFormat="24"></p-calendar>
      </div>
      <div class="p-field">
        <label for="checkOut">יציאה</label>
        <p-calendar [(ngModel)]="editedCheckOut" dateFormat="dd/mm/yy" showTime="true" hourFormat="24"></p-calendar>
      </div>
    </div>
    <p-footer>
      <p-button label="שמור" icon="pi pi-check" (click)="saveEditedWorkLog()"></p-button>
      <p-button label="ביטול" icon="pi pi-times" (click)="cancelEdit()"></p-button>
    </p-footer>
  </p-dialog>
</div>  -->
<!-- <div>
  <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
  </div>
  <div>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>
  <div>
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="workLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>מספר עובד</th>
          <th>תאריך</th>
          <th>כניסה</th>
          <th>יציאה</th>
          <th>שעות עבודה כולל</th>
          <th>פעולות</th>
        </tr>
      </ng-template>
      
      <ng-template pTemplate="body" let-log>
        <tr>
          <td>{{ log.employeeId }}</td>
          <td>{{ log.date | date: 'dd/MM/yyyy' }}</td>
          <td>
            <ng-container *ngFor="let timeEntry of log.timeEntries">
              {{ timeEntry.checkIn | date: 'HH:mm' }}
              <br *ngIf="timeEntry.checkOut" />
            </ng-container>
          </td>
          <td>
            <ng-container *ngFor="let timeEntry of log.timeEntries">
              {{ timeEntry.checkOut ? (timeEntry.checkOut | date: 'HH:mm') : '---' }}
              <br *ngIf="!timeEntry.checkOut" />
            </ng-container>
          </td>
          <td>{{ log.allhoursWorked ? log.allhoursWorked.toFixed(2) : '---' }}</td>
          <td>
            <button (click)="editWorkLog(log)">עריכה</button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div> -->
<!-- <div>
  <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button *ngIf="!hasOpenTimeEntry(logGroup)" label="כניסה" icon="pi pi-sign-in" (click)="checkIn(logGroup)"></p-button>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>

  <div *ngIf="groupedWorkLogs && groupedWorkLogs.length > 0">
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="groupedWorkLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>תאריך</th>
          <th>מספר עובד</th>
          <th>שעות עבודה כולל</th>
          <th>פעולות</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-logGroup>
        <tr>
          <td>
            <p-button icon="pi pi-plus" (click)="logGroup.expanded = !logGroup.expanded"></p-button>
            {{ logGroup.date }}
          </td>
          <td>{{ logGroup.employeeId }}</td>
          <td>{{ logGroup.totalHoursWorked ? logGroup.totalHoursWorked.toFixed(2) : '---' }}</td>
          <td>
            <p-button label="עריכה" icon="pi pi-pencil" (click)="editWorkLog(logGroup)"></p-button>
          </td>
        </tr>
        <tr *ngIf="logGroup.expanded">
          <td colspan="4">
            <p-table [value]="logGroup.logs">
              <ng-template pTemplate="header">
                <tr>
                  <th>שעת כניסה</th>
                  <th>שעת יציאה</th>
                  <th>סה"כ שעות</th>
                  <th>פעולות</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-logEntry>
                <tr *ngFor="let log of logEntry.timeEntries">
                  <td>{{ log.checkIn | date: 'HH:mm' }}</td>
                  <td>{{ log.checkOut ? (log.checkOut | date: 'HH:mm') : '---' }}</td>
                  <td>{{ log.hoursWorked ? log.hoursWorked.toFixed(2) : '---' }}</td>
                  <td>
                    <p-button label="עריכה" icon="pi pi-pencil" (click)="editTimeEntry(logGroup, log)"></p-button>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <p-dialog header="עריכת יומן עבודה" [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{width: '50vw', height: '100vh'}">
    <div class="p-fluid">
      <div class="p-field">
        <label for="checkIn">שעת כניסה</label>
        <p-calendar id="checkIn" [(ngModel)]="editedCheckIn" showTime="true" hourFormat="24"></p-calendar>
      </div>
      <div class="p-field">
        <label for="checkOut">שעת יציאה</label>
        <p-calendar id="checkOut" [(ngModel)]="editedCheckOut" showTime="true" hourFormat="24"></p-calendar>
      </div>
    </div>
    <p-footer>
      <p-button label="שמירה" icon="pi pi-check" (click)="saveEditedWorkLog()"></p-button>
      <p-button label="ביטול" icon="pi pi-times" (click)="cancelEdit()"></p-button>
    </p-footer>
  </p-dialog>
</div> -->


<!-- <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
  </div>
  <div>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>
  <div>
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="workLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>מספר עובד</th>
          <th>תאריך</th>
          <th>כניסה</th>
          <th>יציאה</th>
          <th>שעות עבודה</th>
          <th>פעולות</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-log>
        <tr>
          <td>{{ log.employeeId }}</td>
          <td>{{ log.date | date: 'dd/MM/yyyy' }}</td>
          <td>{{ log.checkIn | date: 'HH:mm' }}</td>
          <td>{{ log.checkOut ? (log.checkOut | date: 'HH:mm') : '---' }}</td>
          <td>{{ log.hoursWorked ? log.hoursWorked.toFixed(2) : '---' }}</td>
          <td>
            <p-button label="עריכה" icon="pi pi-pencil" (click)="editWorkLog(log)"></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div>
    <label>חודש</label>
    <input pInputText type="number" [(ngModel)]="exportMonth" placeholder="חודש">
    <label>שנה</label>
    <input pInputText type="number" [(ngModel)]="exportYear" placeholder="שנה">
    <p-button label="ייצוא" icon="pi pi-file-excel" (click)="exportWorkLogs(exportMonth, exportYear)"></p-button>
  </div>

  <p-dialog header="עריכת שעות עבודה" [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{width: '50vw', height: '50vh'}">
    <div class="p-grid p-fluid">
      <div class="p-field">
        <label for="checkIn">כניסה</label>
        <p-calendar [(ngModel)]="editedCheckIn" timeOnly="true" showTime="true" hourFormat="24"></p-calendar>
      </div>
      <div class="p-field">
        <label for="checkOut">יציאה</label>
        <p-calendar [(ngModel)]="editedCheckOut" timeOnly="true" showTime="true" hourFormat="24"></p-calendar>
      </div>
    </div>
    <p-footer>
      <p-button label="שמור" icon="pi pi-check" (click)="saveEditedWorkLog()"></p-button>
      <p-button label="ביטול" icon="pi pi-times" (click)="cancelEdit()"></p-button>
    </p-footer>
  </p-dialog> -->

<!-- <div>
  <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
  </div>
  <div>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>
  <div>
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="workLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>מספר עובד</th>
          <th>תאריך</th>
          <th>כניסה</th>
          <th>יציאה</th>
          <th>שעות עבודה</th>
          <th>שעות נוספות</th>
          <th>פעולות</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-log>
        <tr>
          <td>{{ log.employeeId }}</td>
          <td>{{ log.date | date: 'dd/MM/yyyy' }}</td>
          <td>{{ log.checkIn | date: 'HH:mm' }}</td>
          <td>{{ log.checkOut ? (log.checkOut | date: 'HH:mm') : '---' }}</td>
          <td>{{ log.hoursWorked ? log.hoursWorked.toFixed(2) : '---' }}</td>
          <td>
            {{ log.hoursWorked && log.hoursWorked > 8.4 ? (log.hoursWorked - 8.4).toFixed(2) : '0.00' }}
          </td>
          <td>
            <p-button label="עריכה" icon="pi pi-pencil" (click)="editWorkLog(log)"></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div>
    <label>חודש</label>
    <input pInputText type="number" [(ngModel)]="exportMonth" placeholder="חודש">
    <label>שנה</label>
    <input pInputText type="number" [(ngModel)]="exportYear" placeholder="שנה">
    <p-button label="ייצוא לאקסל" icon="pi pi-file-excel" (click)="exportWorkLogs(exportMonth, exportYear)"></p-button>
  </div>

  <p-dialog header="עריכת שעות עבודה" [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{width: '50vw', height: '100vh'}">
    <div class="p-grid p-fluid">
      <div class="p-field">
        <label for="checkIn">כניסה</label>
        <p-calendar [(ngModel)]="editedCheckIn" dateFormat="dd/mm/yy" showTime="true" hourFormat="24"></p-calendar>
      </div>
      <div class="p-field">
        <label for="checkOut">יציאה</label>
        <p-calendar [(ngModel)]="editedCheckOut" dateFormat="dd/mm/yy" showTime="true" hourFormat="24"></p-calendar>
      </div>
    </div>
    <p-footer>
      <p-button label="שמור" icon="pi pi-check" (click)="saveEditedWorkLog()"></p-button>
      <p-button label="ביטול" icon="pi pi-times" (click)="cancelEdit()"></p-button>
    </p-footer>
  </p-dialog>
</div> -->
<!-- <div>
  <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
  </div>
  <div>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>
  <div>
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="workLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>מספר עובד</th>
          <th>תאריך</th>
          <th>כניסה</th>
          <th>יציאה</th>
          <th>שעות עבודה כולל</th>
          <th>פעולות</th>
        </tr>
      </ng-template>
      
<ng-template pTemplate="body" let-log>
  <tr>
    <td>{{ log.employeeId }}</td>
    <td>{{ log.date | date: 'dd/MM/yyyy' }}</td>
    <td>
      <ng-container *ngFor="let timeEntry of log.timeEntries">
        {{ timeEntry.checkIn | date: 'HH:mm' }}
        <br *ngIf="timeEntry.checkOut" />
      </ng-container>
    </td>
    <td>
      <ng-container *ngFor="let timeEntry of log.timeEntries">
        {{ timeEntry.checkOut ? (timeEntry.checkOut | date: 'HH:mm') : '---' }}
        <br *ngIf="!timeEntry.checkOut" />
      </ng-container>
    </td>
    <td>{{ log.allhoursWorked ? log.allhoursWorked.toFixed(2) : '---' }}</td>
    <td>
      <p-button label="עריכה" icon="pi pi-pencil" (click)="editWorkLog(log)"></p-button>
    </td>
  </tr>
</ng-template>
    </p-table>
  </div>

  <div>
    <label>חודש</label>
    <input pInputText type="number" [(ngModel)]="exportMonth" placeholder="חודש">
    <label>שנה</label>
    <input pInputText type="number" [(ngModel)]="exportYear" placeholder="שנה">
    <p-button label="ייצוא לאקסל" icon="pi pi-file-excel" (click)="exportWorkLogs(exportMonth, exportYear)"></p-button>
  </div>

  <p-dialog header="עריכת שעות עבודה" [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{width: '50vw', height: '100vh'}">
    <div class="p-grid p-fluid">
      <div class="p-field">
        <label for="checkIn">כניסה</label>
        <p-calendar [(ngModel)]="editedCheckIn" dateFormat="dd/mm/yy" showTime="true" hourFormat="24"></p-calendar>
      </div>
      <div class="p-field">
        <label for="checkOut">יציאה</label>
        <p-calendar [(ngModel)]="editedCheckOut" dateFormat="dd/mm/yy" showTime="true" hourFormat="24"></p-calendar>
      </div>
    </div>
    <p-footer>
      <p-button label="שמור" icon="pi pi-check" (click)="saveEditedWorkLog()"></p-button>
      <p-button label="ביטול" icon="pi pi-times" (click)="cancelEdit()"></p-button>
    </p-footer>
  </p-dialog>
</div>  -->
 <!-- <div>
  <h2>ניהול שעות עבודה</h2>

  <div>
    <p-button label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
  </div>
  <div>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>
  <div>
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="workLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>מספר עובד</th>
          <th>תאריך</th>
          <th>כניסה</th>
          <th>יציאה</th>
          <th>שעות עבודה כולל</th>
          <th>פעולות</th>
        </tr>
      </ng-template>
      
      <ng-template pTemplate="body" let-log>
        <tr>
          <td>{{ log.employeeId }}</td>
          <td>{{ log.date | date: 'dd/MM/yyyy' }}</td>
          <td>
            <ng-container *ngFor="let timeEntry of log.timeEntries">
              {{ timeEntry.checkIn | date: 'HH:mm' }}
              <br *ngIf="timeEntry.checkOut" />
            </ng-container>
          </td>
          <td>
            <ng-container *ngFor="let timeEntry of log.timeEntries">
              {{ timeEntry.checkOut ? (timeEntry.checkOut | date: 'HH:mm') : '---' }}
              <br *ngIf="!timeEntry.checkOut" />
            </ng-container>
          </td>
          <td>{{ log.allhoursWorked ? log.allhoursWorked.toFixed(2) : '---' }}</td>
          <td>
            <button (click)="editWorkLog(log)">עריכה</button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div> -->
<div> 
  <h2>ניהול שעות עבודה</h2>

  <div>
    <!-- *ngIf="logGroup && !hasOpenTimeEntry(logGroup)" -->
    <p-button  label="כניסה" icon="pi pi-sign-in" (click)="checkIn()"></p-button>
    <p-button label="יציאה" icon="pi pi-sign-out" (click)="checkOut()"></p-button>
  </div>

  <div *ngIf="groupedWorkLogs ">
    <h3>רשימת יומני עבודה</h3>
    <p-table [value]="groupedWorkLogs">
      <ng-template pTemplate="header">
        <tr>
          <th>תאריך</th>
          <th>מספר עובד</th>
          <th>שעות עבודה כולל</th>
          <th>פעולות</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-logGroup>
        <tr>
          <td>
            <p-button icon="pi pi-plus" (click)="logGroup.expanded = !logGroup.expanded"></p-button>
            {{ logGroup.date }}
          </td>
          <td>{{ logGroup.employeeId }}</td>
          <td>{{ logGroup.totalHoursWorked ? logGroup.totalHoursWorked.toFixed(2) : '---' }}</td>
          <td>
            <p-button label="עריכה" icon="pi pi-pencil" (click)="editWorkLog(logGroup)"></p-button>
          </td>
        </tr>
        <tr *ngIf="logGroup.expanded">
          <td colspan="4">
            <p-table [value]="logGroup.logs">
              <ng-template pTemplate="header">
                <tr>
                  <th>שעת כניסה</th>
                  <th>שעת יציאה</th>
                  <th>סה"כ שעות</th>
                  <th>פעולות</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-logEntry>
                <tr *ngFor="let log of logEntry.timeEntries">
                  <td>{{ log.checkIn | date: 'HH:mm' }}</td>
                  <td>{{ log.checkOut ? (log.checkOut | date: 'HH:mm') : '---' }}</td>
                  <td>{{ log.hoursWorked ? log.hoursWorked.toFixed(2) : '---' }}</td>
                  <td>
                    <p-button label="עריכה" icon="pi pi-pencil" (click)="editTimeEntry(logGroup, log)"></p-button>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <p-dialog header="עריכת יומן עבודה" [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{width: '50vw', height: '100vh'}">
    <div class="p-fluid">
      <div class="p-field">
        <label for="checkIn">שעת כניסה</label>
        <p-calendar id="checkIn" [(ngModel)]="editedCheckIn" showTime="true" hourFormat="24"></p-calendar>
      </div>
      <div class="p-field">
        <label for="checkOut">שעת יציאה</label>
        <p-calendar id="checkOut" [(ngModel)]="editedCheckOut" showTime="true" hourFormat="24"></p-calendar>
      </div>
    </div>
    <p-footer>
      <p-button label="שמירה" icon="pi pi-check" (click)="saveEditedWorkLog()"></p-button>
      <p-button label="ביטול" icon="pi pi-times" (click)="cancelEdit()"></p-button>
    </p-footer>
  </p-dialog>
</div>
<button pButton type="button" label="Export to Excel" icon="pi pi-file-excel" class="p-button-success" (click)="exportToExcel()"></button>
